<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  
  <title>inBetween</title>
  
  <meta name="description" content="inBetween" />
  <meta name="keywords" value="inBetween webapp HTML5 jquery geolocation javascript" />

  <script type="text/javascript" src="js/jquery.min.js"> </script>
  <script type="text/javascript" src="js/jquery.form.js"> </script>

  <script type="text/javascript" src="http://maps.google.com/maps?file=api&amp;v=2&amp;key=AIzaSyBBHnPSnGsWXVzwAlUhBQdb9WAw8HWB2uw&sensor=true"> </script>

  <script type="text/javascript" src="js/fsqLoc.js"> </script>

	<link rel="stylesheet" type="text/css" href="css/style.css" />
<script type="text/javascript">

function getLocs(first, second, point) {

		var yourLoc = first;
		var otherLoc = second;
		var poi = point;

		var latitude = 0;
		var longitude = 0;

/*		function getLat(address) {
			
			var geo = new google.maps.Geocoder;
			geo.geocode({'address':address},function(results, status){
    			if (status == google.maps.GeocoderStatus.OK) {              
        			latitude = results[0].geometry.location.lat();
    			}
			});
			return latitude;
		}

		function getLon(address) {
			
			var geo = new google.maps.Geocoder;
			geo.geocode({'address':address},function(results, status){
    			if (status == google.maps.GeocoderStatus.OK) {              
        			longitude = results[0].geometry.location.lng();
    			}
			});
			return longitude;
		}

    	function getLat(address) {
    		var map = new GMap2(document.getElementById("map_canvas"));
			var geocoder = new GClientGeocoder();
			var latitude = 0;
			var longitude = 0;
			geocoder.getLatLng(address, function(point) {
         	latitude = point.y;
         	longitude = point.x;  
         	});
         	return latitude;
    	}

    	function getLon(address) {
    		var map = new GMap2(document.getElementById("map_canvas"));
			var geocoder = new GClientGeocoder();
			var latitude = 0;
			var longitude = 0;
			geocoder.getLatLng(address, function(point) {
         	latitude = point.y;
         	longitude = point.x;  
         	});
         	return longitude;
    	}
*/
    	var yourLat = getLat(yourLoc);
    	var otherLat = getLat(otherLoc);
    	var lat = (yourLat + otherLat)/2;
    	// console.log(lat);

    	var yourLon = getLon(yourLoc);
    	var otherLon = getLon(otherLoc);
    	var lon = (yourLon + otherLon)/2;
    	// console.log(lon);

		var lati = (lat).toString();
		var longi = (lon).toString();
		var query = poi;

		printLocs(lati, longi, point);
}

function printLocs(lati, longi, query){
	var url = 'https://api.foursquare.com/v2/venues/search?ll='+lati+','+longi+'&query='+query+'&client_id=2POUFAUU4ZBJ2MTDOY3S2YHR2NIT52FYW0LUTPHBMNTJFJNQ&client_secret=YFDZI1YWV3ZI5S5SPM2DZJEQIEBPIDJ5XFZBWTIKIQZVQNYM&v=20120101';

		$.getJSON(url,
		    function(data) {
		        $.each(data.response.venues, function(i,venues){
		            content = '<center>';
		            content += '<p> <br />';
					if(venues.name != null) {
						content += '&nbsp;' + venues.name + '<br />';
					}
					if(venues.location.address != null) {
						content += '&nbsp;' + venues.location.address + '<br />';
					}
					if(venues.location.crossStreet != null) {
						content += ' &nbsp;' + venues.location.crossStreet + '<br />';
					}
					if(venues.location.city != null) {
						content += ' &nbsp;' + venues.location.city + ', ';
					}
					if(venues.location.state != null) {
						content += ' &nbsp;' + venues.location.state + '';
					}
					if(venues.location.postalCode != null) {
						content += ' &nbsp;' + venues.location.postalCode + '';
					}
					if(venues.location.distance != null) {
						content += '<br /> &nbsp; Distance: ' + venues.location.distance + '<br />';
					}
					if(venues.contact.phone != null) {
						content += '&nbsp;' + venues.location.phone + '<br />';
					}
					content += '</p> </center>';
					$(content).appendTo("#names");
		       });
		});
}

</script>

<script> 
        $(document).ready(function() { 
            $('#your_loc').ajaxForm(function() { 
            }); 
        }); 
</script> 

</head>
<body>

	<div id="logo">
		<center>
			<h1>inBetween</h1>
		</center>
	</div>

	<div id="head">
		<center>
			Tell us where you are, and where your friend is. <br />
			We'll help you find cool places <strong><em>inBetween</em></strong> you! <br />
			</br>
		</center>
	</div>

	<script>
		var yours = '';
		var other = '';
		var interst = '';

		function formSubmit() {
			yours = document.getElementById("yourPlace").value;
			other = document.getElementById("otherPlace").value;
			interest = document.getElementById("interestType").value;

			// getLocs(yours,interest,other);
			printLocs(40.5592,-74.3164,'');
		}

	</script>

	<div id="top">
		<center>
		<form id="your_loc" method="post" action="javascript:formSubmit()">
			<label for="yourPlace">Where are you now? </label>
			<input type="text" id="yourPlace" name="yourPlace" size="25" maxLength="160"></input>
			<br />
			<label for="otherPlace">Where's your friend? </label>
			<input type="text" id="otherPlace" name="otherPlace" size="25" maxLength="160"></input>
			<br />
			<label for="interestType">Place of interest? </label>
			<input type="text" id="interestType" name="interestType" size="25" maxLength="160"></input>
			<br /> <br />
			<input type="submit" id="submit" name="submit" value="Let's go!" />
			<br />
		</form>
		</center>
	</div>
	
	<div id="head">
		<center>
			<br /> Now check out the awesome places nearby! <br />
		</center>
	</div>

	<div id="map_canvas"></div>
	<div id="names"></div>
</body>
</html>